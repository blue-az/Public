<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Architecture | Stan</title>
    <meta name="description" content="Four-Phase Agentic Framework architecture for the Stan domain.">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header class="header">
        <div class="header-top">
            <a href="https://proto.efehnconsulting.com/project-phoenix/">Part of Project Phoenix</a>
        </div>
        <div class="header-main">
            <a href="index.html" class="logo">
                <span class="logo-mark">Stan</span>
                <span class="logo-text">Statistical Learning</span>
            </a>
            <nav class="header-nav">
                <a href="index.html">Explore</a>
                <a href="architecture.html" class="active">Architecture</a>
                <a href="tools.html">Tools</a>
                <a href="cockpit.html">Cockpit</a>
            </nav>
        </div>
    </header>

    <div class="breadcrumb">
        <a href="index.html">Home</a>
        <span>/</span>
        Architecture
    </div>

    <div class="page-content">
        <section class="section">
            <h2>Four-Phase Agentic Framework</h2>
            <p>Stan implements the complete Project Phoenix Four-Phase Framework, providing progressive levels of transparency and control for agentic interactions.</p>

            <div class="phases-grid">
                <div class="phase-card">
                    <span class="phase-num">0</span>
                    <h4>Foundation</h4>
                    <p>CLI, tools, data client</p>
                    <span class="status-badge complete">Complete</span>
                </div>
                <div class="phase-card">
                    <span class="phase-num">1</span>
                    <h4>Glass Box</h4>
                    <p>Plan builder, agentic engine</p>
                    <span class="status-badge complete">Complete</span>
                </div>
                <div class="phase-card">
                    <span class="phase-num">2</span>
                    <h4>Human-in-Loop</h4>
                    <p>Pause, resume, cancel</p>
                    <span class="status-badge complete">Complete</span>
                </div>
                <div class="phase-card">
                    <span class="phase-num">3</span>
                    <h4>Progressive Disclosure</h4>
                    <p>Expandable step details</p>
                    <span class="status-badge complete">Complete</span>
                </div>
                <div class="phase-card">
                    <span class="phase-num">4</span>
                    <h4>Multi-Modal Output</h4>
                    <p>Artifact workspace, exports</p>
                    <span class="status-badge complete">Complete</span>
                </div>
            </div>
        </section>

        <section class="section">
            <h2>Component Architecture</h2>
            <div class="code-block">
unified_agent/
    data_client.py      <span class="comment"># StanDataClient: homework metadata access</span>
    tool_registry.py    <span class="comment"># ToolRegistry: 17+ registered tools</span>
    execution_context.py <span class="comment"># ExecutionContext: shared state</span>
    plan_builder.py     <span class="comment"># PlanBuilder: query to ExecutionPlan</span>
    agentic_engine.py   <span class="comment"># AgenticEngine: state machine orchestrator</span>

cli/main.py             <span class="comment"># Interactive REPL or command-line</span>
cockpit/stan_cockpit.py <span class="comment"># Tkinter GUI (all four phases)</span>
            </div>

            <h3>Core Flow</h3>
            <ol>
                <li><strong>Query</strong>: PlanBuilder.build_plan() matches patterns to generate ExecutionPlan</li>
                <li><strong>Plan</strong>: AgenticEngine transitions: IDLE to PLANNING to AWAITING_APPROVAL</li>
                <li><strong>Execute</strong>: ToolRegistry dispatches to handlers, results stored in ExecutionContext</li>
                <li><strong>Result</strong>: Engine transitions to COMPLETED, GUI updates artifact workspace</li>
            </ol>
        </section>

        <section class="section">
            <h2>State Machine</h2>
            <p>The AgenticEngine manages execution through a well-defined state machine:</p>
            <div class="code-block">
IDLE
  |
  v
PLANNING
  |
  v
AWAITING_APPROVAL --[cancel]--> IDLE
  |
  [approve]
  |
  v
RUNNING --[pause]--> PAUSED --[resume]--> RUNNING
  |                     |
  [complete]        [cancel]
  |                     |
  v                     v
COMPLETED             IDLE
            </div>

            <h3>State Descriptions</h3>
            <table class="data-table">
                <thead>
                    <tr>
                        <th>State</th>
                        <th>Description</th>
                        <th>Valid Transitions</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>IDLE</code></td>
                        <td>Ready to accept new queries</td>
                        <td>PLANNING</td>
                    </tr>
                    <tr>
                        <td><code>PLANNING</code></td>
                        <td>Building execution plan from query</td>
                        <td>AWAITING_APPROVAL, IDLE (on error)</td>
                    </tr>
                    <tr>
                        <td><code>AWAITING_APPROVAL</code></td>
                        <td>Plan ready, waiting for user approval</td>
                        <td>RUNNING, IDLE (on cancel)</td>
                    </tr>
                    <tr>
                        <td><code>RUNNING</code></td>
                        <td>Executing plan steps</td>
                        <td>PAUSED, COMPLETED, IDLE (on error)</td>
                    </tr>
                    <tr>
                        <td><code>PAUSED</code></td>
                        <td>Execution paused by user</td>
                        <td>RUNNING, IDLE (on cancel)</td>
                    </tr>
                    <tr>
                        <td><code>COMPLETED</code></td>
                        <td>All steps executed successfully</td>
                        <td>IDLE (on reset)</td>
                    </tr>
                </tbody>
            </table>
        </section>

        <section class="section">
            <h2>Pattern Matching</h2>
            <p>The PlanBuilder uses regex patterns matched in priority order (most-specific first):</p>

            <h3>Pattern Categories</h3>
            <table class="data-table">
                <thead>
                    <tr>
                        <th>Priority</th>
                        <th>Category</th>
                        <th>Example Queries</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>1</td>
                        <td>Cross-homework</td>
                        <td>"compare homework 1 and 4", "chapter 7"</td>
                    </tr>
                    <tr>
                        <td>2</td>
                        <td>Homework-specific</td>
                        <td>"homework 1", "KNN", "naive bayes"</td>
                    </tr>
                    <tr>
                        <td>3</td>
                        <td>Exploration</td>
                        <td>"list scripts", "show capabilities"</td>
                    </tr>
                </tbody>
            </table>
        </section>

        <section class="section">
            <h2>Data Source</h2>
            <p>Homework scripts and data are read from <code>~/Python/Stan/</code>:</p>
            <div class="code-block">
~/Python/Stan/
    ESLII_print12_toc.pdf    <span class="comment"># Textbook reference</span>
    Stats315ASubmission.pdf   <span class="comment"># Course submission</span>
    Hmk1/                     <span class="comment"># KNN Classification</span>
        1/                    <span class="comment"># Problem 1 scripts</span>
    Hmk2/                     <span class="comment"># Zipcode Analysis</span>
    Hmk3/                     <span class="comment"># Discriminant Analysis</span>
        DA/                   <span class="comment"># Golf analysis</span>
    Hmk4/                     <span class="comment"># Naive Bayes</span>
        18.9/                 <span class="comment"># Data piling</span>
            </div>
        </section>
    </div>

    <footer class="footer">
        <div class="footer-content">
            <div>
                <h4>Stan Domain</h4>
                <a href="index.html">Explore Homeworks</a>
                <a href="architecture.html">Architecture</a>
                <a href="tools.html">Tool Registry</a>
                <a href="cockpit.html">Agentic Cockpit</a>
            </div>
            <div>
                <h4>Reference</h4>
                <a href="#">Elements of Statistical Learning</a>
                <a href="https://proto.efehnconsulting.com/project-phoenix/">Project Phoenix</a>
            </div>
        </div>
        <div class="footer-bottom">
            <p>Stan Domain - Project Phoenix Framework | Built on tau-bench (MIT License, Sierra Research)</p>
        </div>
    </footer>
</body>
</html>
